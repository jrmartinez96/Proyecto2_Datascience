h1<-table(ventas.centroamerica$`Año Mes`>201812)
h1
h1<-table(ventas.centroamerica$`Año Mes` %in% 2018)
h1
h1<-table(ventas.centroamerica$`Año Mes` %in% 2019)
h1
h1<-table(ventas.centroamerica$`Año Mes`)
h1
plot(h1)
h1<-table(ventas.centroamerica$`Año Mes` == "2018")
h1
h1<-table(ventas.centroamerica$`Año Mes` == "201801")
h1
plot(h1)
h1<-table(ventas.centroamerica$`Año Mes`)
h1
h1[1]
h1[12]
h1[1:12]
plot(h1[1:12])
meses<-c("Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago","Sept", "Oct", "Nov","Dic")
plot(h1[1:12], labels(meses))
?plot
plot(h1[1:12], xlab = meses)
plot(h1[1:12], labels = meses)
?plot
plot(h1[1:12])
?plot
h1[1:12]
plot(h1[1:12], xlim = 12)
plot(h1[1:12], xlim = 11)
plot(h1[1:12], xlim = 1)
plot(h1[1:12], xlim = 10)
plot(h1[1:12], ylim = 12)
plot(h1[1:12], ylim = 1)
plot(h1[1:12], break())
plot(h1[1:12], break(1))
plot(h1[1:12]))
plot(h1[1:12])
ventas2018<-h1[1:12]
plot(ventas2018)
scatterplot3d::scatterplot3d(ventas2018)
barplot(ventas2018)
barplot(ventas2018, main = "VENTAS EN 2018")
h1[13,]
h1[,13]
h1
h1[13:19]
h1[13:20]
h1[13:19]
ventas2019<-h1[13:19]
barplot(ventas2019)
barplot(h1)
barplot(ventas2019, xlab = meses)
barplot(ventas2019, labels(meses))
barplot(ventas2019, labels(as.numeric(meses)))
barplot(ventas2019)
barplot(ventas2019, axisnames = meses)
barplot(ventas2019, names.arg = meses)
barplot(ventas2019)
barplot(ventas2018, main = "VENTAS EN 2018", names.arg = meses)
barplot(ventas2019, main = "VENTAS EN 2019", names.arg = meses2)
meses2<-c("Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul")
barplot(ventas2019, main = "VENTAS EN 2019", names.arg = meses2)
barplot(h1, main = "VENTAS TOTALES", names.arg = c(meses, meses2))
barplot(ventas2018, main = "VENTAS EN 2018", names.arg = meses)
barplot(ventas2019, main = "VENTAS EN 2019", names.arg = meses2)
barplot(h1, main = "VENTAS TOTALES", names.arg = c(meses, meses2))
View(ventas.centroamerica)
# PRODUCTO
str(producto)
FRECventas2018<-h1[1:12]
FRECventas2019
barplot(FRECventas2019, main = "VENTAS EN 2019", names.arg = meses2)
FRECventas2019<-h1[13:19]
barplot(FRECventas2019, main = "VENTAS EN 2019", names.arg = meses2)
barplot(h1, main = "VENTAS TOTALES", names.arg = c(meses, meses2))
# PRODUCTO
str(ventas.centroamerica$Producto)
# PRODUCTO
str(as.factor(ventas.centroamerica$Producto))
table(as.factor(ventas.centroamerica$Producto))
barplot(table(as.factor(ventas.centroamerica$Producto)))
barplot(table(as.factor(ventas.centroamerica$Producto)))
max(table(as.factor(ventas.centroamerica$Producto)))
Paginacion <- read_excel("Paginacion 2015-2019.xlsx")
ventas.centroamerica
colnames(ventas.centroamerica)
h1<-table(Paginacion$`Año Mes`)
FRECventas2018<-h1[1:12]
meses<-c("Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago","Sept", "Oct", "Nov","Dic")
meses2<-c("Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul")
barplot(FRECventas2018, main = "VENTAS EN 2018", names.arg = meses)
h1
h1<-table(ventas.centroamerica$`Año Mes`)
FRECventas2018<-h1[1:12]
meses<-c("Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago","Sept", "Oct", "Nov","Dic")
meses2<-c("Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul")
barplot(FRECventas2018, main = "VENTAS EN 2018", names.arg = meses)
FRECventas2019<-h1[13:19]
barplot(FRECventas2019, main = "VENTAS EN 2019", names.arg = meses2)
barplot(h1, main = "VENTAS TOTALES", names.arg = c(meses, meses2))
# PRODUCTO
str(as.factor(ventas.centroamerica$Producto))
table(as.factor(ventas.centroamerica$Producto))
barplot(table(as.factor(ventas.centroamerica$Producto)))
barplot(head(table(as.factor(ventas.centroamerica$Producto)))
barplot(head(table(as.factor(ventas.centroamerica$Producto)))
barplot(head(table(as.factor(ventas.centroamerica$Producto))))
barplot(table(as.factor(ventas.centroamerica$Producto)))
table(as.factor(ventas.centroamerica$Producto))
?order
order(table(as.factor(ventas.centroamerica$Producto)),decreasing = TRUE)
order(table(as.factor(ventas.centroamerica$Producto)),decreasing = FALSE)
table(as.factor(ventas.centroamerica$Producto))
barplot(table(as.factor(ventas.centroamerica$Producto)))
max.col(table(as.factor(ventas.centroamerica$Producto)))
max(table(as.factor(ventas.centroamerica$Producto)))
plot(table(as.factor(ventas.centroamerica$Producto)))
barplot(table(as.factor(ventas.centroamerica$Producto)))
productos<-table(as.factor(ventas.centroamerica$Producto))
barplot(productos)
str(productos)
head(productos)
max(productos)
order(productos,decreasing = TRUE)
order(productos,decreasing = FALSE)
sort.list(table)
sort(table)
productos$4116260008
ggplot2::qplot(productos)
ggplot2::ggplot(h1)
ggplot2::ggplot(ventas.centroamerica$`Año Mes`)
ggplot2::ggplot(as.data.frame.array(h1))
ggplot2::ggplot(as.data.frame(h1))
ggplot2:barplot(h1)
library("ggplot2")
ggplot2:barplot(h1)
library("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
library("ggplot2")
ggplot2:barplot(h1)
barplot(h1, main = "VENTAS TOTALES", names.arg = c(meses, meses2))
barplot(productos)
str(productos)
productos
-productos
# PRODUCTO
productos<-table(as.factor(ventas.centroamerica$Producto))
str(productos)
productos
order(-productos)
barplot(-productos)
barplot(-productos,)
order(productos)
barplot(h1)
h1<-order(productos)
barplot(h1)
barplot(productos)
h1<-productos[order(productos)]
barplot(h1)
h1<-productos[order(-productos)]
barplot(h1)
count(productos)
count(h1)
barplot(head(h1)
barplot(head(h1))
barplot(head(h1))
plot(head(h1))
graphics::pie(head(h1))
graphics::plot(head(h1))
graphics::boxplot(head(h1))
graphics::barplot(head(h1))
barplot(head(h1), )
?barplot
?head
barplot(head(h1, n = 10L))
barplot(head(h1, n = 10L))
?barplot
barplot(head(h1, n = 10L), height = 4)
barplot(head(h1, n = 10L), height = 1)
barplot(head(h1, n = 10L), height = 0.1)
barplot(head(h1, n = 10L), height = 80)
barplot(head(h1, n = 10L))
?barplot
barplot(head(h1, n = 10L), beside = TRUE)
barplot(head(h1, n = 10L), beside = FALSE)
?barplot
barplot(head(h1, n = 10L), horiz = TRUE)
?barplot
text(x = xx, y = head(h1, n = 10L), label = dat$freqs, pos = 3, cex = 0.8, col = "red")
xx<-barplot(head(h1, n = 10L), horiz = TRUE)
xx<-barplot(head(h1, n = 10L))
text(x = xx, y = head(h1, n = 10L), label = dat$freqs, pos = 3, cex = 0.8, col = "red")
text(x = xx, y = head(h1, n = 10L), pos = 3, cex = 0.8, col = "red")
text(x = xx, y = head(h1, n = 10L), pos = 9, cex = 0.8, col = "red")
text(x = xx, y = head(h1, n = 10L), pos = 1, cex = 0.8, col = "red")
text(x = xx, y = head(h1, n = 10L), pos = 1, cex = 1, col = "red")
text(x = xx, y = head(h1), pos = 1, cex = 0.8, col = "red")
xx<-barplot(head(h1, n = 10L))
text(x = xx, y = head(h1), pos = 1, cex = 0.8, col = "red")
head(h1)
head(h1, n = 10)
xx<-barplot(head(h1, n = 10))
text(x = xx, y = head(h1, n=10), pos = 1, cex = 0.8, col = "red")
head(h1, n = 10)
yy<-c(73,73,72,72,71,70,70,70,70,70)
xx<-barplot(head(h1, n = 10))
text(x = xx, y = yy, pos = 1, cex = 0.8, col = "red")
text(x = xx, y = yy,labels = yy pos = 1, cex = 0.8, col = "red")
text(x = xx, y = yy,labels = yy, pos = 1, cex = 0.8, col = "red")
text(x = xx,labels = yy, pos = 1, cex = 0.8, col = "red")
xx<-barplot(head(h1, n = 10))
text(x = xx,labels = yy, pos = 1, cex = 0.8, col = "red")
xx<-barplot(head(h1, n = 10))
head(h1, n = 10)
yy<-c(73,73,72,72,71,70,70,70,70,70)
text(x = xx, y = yy, labels = yy, pos = 1, cex = 0.8, col = "red")
# 4123800056 4123800080 4123800001 4123800030 4123811146 4123660214 4130000001 4130000002 4130000003 4130000004
ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800056"]
# 4123800056 4123800080 4123800001 4123800030 4123811146 4123660214 4130000001 4130000002 4130000003 4130000004
ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800056"][1]
p2<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800080"][1]
p2
p3<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800001"][1]
p2
p3<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800030"][1]
p2
p1
[1]
# 4123800056 4123800080 4123800001 4123800030 4123811146 4123660214 4130000001 4130000002 4130000003 4130000004
p1<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800056"][1]
p2<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800080"][1]
p3<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800001"][1]
p4<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800030"][1]
p1
p2
p3
p4
p4<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800030"][2]
p4
ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800030"]
p4
p5<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123811146"][1]
p5
p7<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4130000001"][1]
p6
p6<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123660214"][1]
p6
p7
p5
p8<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4130000002"][1]
p9<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4130000003"][1]
p10<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4130000004"][1]
ps<-c(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10)
ps
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
xx<-barplot(head(h1, n = 10), names.arg = NULL)
xx<-barplot(head(h1, n = 10), names.arg = )
xx<-barplot(head(h1, n = 10), names.arg = )
barplot(head(h1, n = 10), names.arg = )
xx<-barplot(head(h1, n = 10), names.arg = NA)
head(h1, n = 10)
yy<-c(73,73,72,72,71,70,70,70,70,70)
text(x = xx, y = yy, labels = yy, pos = 1, cex = 0.8, col = "red")
# 4123800056 4123800080 4123800001 4123800030 4123811146 4123660214 4130000001 4130000002 4130000003 4130000004
p1<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800056"][1]
p2<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800080"][1]
p3<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800001"][1]
p4<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800030"][2]
p5<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123811146"][1]
p6<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123660214"][1]
p7<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4130000001"][1]
p8<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4130000002"][1]
p9<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4130000003"][1]
p10<-ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4130000004"][1]
ps<-c(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1, at=xx, labels=ps, tick=FALSE, las=4, line=-0.5, cex.axis=0.5)
axis(1, at=xx, labels=ps, tick=FALSE, las=1, line=-0.5, cex.axis=0.5)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.9, cex.axis=0.5)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.1)
xx<-barplot(head(h1, n = 10), names.arg = NA)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.1)
xx<-barplot(head(h1, n = 10), names.arg = NA)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.4)
xx<-barplot(head(h1, n = 10), names.arg = NA)
axis(2, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = TRUE)
axis(2, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
text(x = xx, y = yy, labels = yy, pos = 1, cex = 0.8, col = "red")
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE)
text(x = xx, y = yy, labels = yy, pos = 1, cex = 0.8, col = "red")
axis(3, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(4, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(5, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1.1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1.5, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE)
axis(1, at=xx, labels=ps, tick=TRUE, las=2, line=-0.5, cex.axis=0.5)
?barplot
h<-c(1,0.9,0.8,0.7,0.6,0.5,0.4,0.3,0.2)
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE,height = h )
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE, width = h )
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE, width = 0.1 )
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE, width = 0.02)
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE, width = 0.22)
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE, width = 0.2)
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE, width = 0.4)
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE)
yy<-c(73,73,72,72,71,70,70,70,70,70)
text(x = xx, y = yy, labels = yy, pos = 1, cex = 0.8, col = "red")
ps
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.5, cex.axis=0.5)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=0.5, cex.axis=0.5)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.9, cex.axis=0.5)
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-0.9, cex.axis=0.5)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-1.5, cex.axis=0.5)
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-4, cex.axis=0.5)
text(x = xx, y = yy, labels = yy, pos = 1, cex = 0.8, col = "red")
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE)
text(x = xx, y = yy, labels = yy, pos = 1, cex = 0.8, col = "red")
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-10, cex.axis=0.5)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-11, cex.axis=0.5)
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE)
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-11, cex.axis=0.5)
text(x = xx, y = yy, labels = yy, pos = 1, cex = 0.8, col = "red")
xx<-barplot(head(h1, n = 10), names.arg = NA, horiz = FALSE, main = "PRODUCTOS MAS VENDIDOS")
yy<-c(73,73,72,72,71,70,70,70,70,70)
text(x = xx, y = yy, labels = yy, pos = 1, cex = 0.8, col = "red")
axis(1, at=xx, labels=ps, tick=FALSE, las=2, line=-11, cex.axis=0.5)
str(head(productos)n=10)
str(head(productos, n = 10))
str(productos)
head(productos, n = 10)
head(h1)
head(h1, n = 10)
ventas.centroamerica$Descripcion[ventas.centroamerica$Producto == "4123800056"][1]
p2
# CODIGO CATALOGO
table(as.factor(ventas.centroamerica$`Codigo Catalogo`))
productos[order(-productos)]
head(productos[order(-productos)], n=10)
# CODIGO CATALOGO
codcat<-table(as.factor(ventas.centroamerica$`Codigo Catalogo`))
codcat
max(codcat)
h1<-codcat[order(-codcat)]
h1
head(h1)
View(ventas.centroamerica)
h1<-productos[order(-productos)]
head(h1)
# CODIGO CATEGORIA
categorias<-table(ventas.centroamerica$Categoria)
categorias
categorias
categorias
plot(categorias)
barplot(categorias)
barplot(head(categorias, n=10))
h1<-categorias[order(-categorias)]
h1
barplot(h1)
el_salvador <- read_excel("el_salvador.xlsx", range = "A2:AE6370")
nicaragua <- read_excel("nicaragua.xlsx", range = "A2:AE6374")
honduras <- read_excel("honduras.xlsx", range = "A2:AE6685")
guatemala <- read_excel("guatemala.xlsx",range = "A2:AE7719")
#Librerias
#Programa para juntar todos los xls en una tabla y exportar un RDATA
library("readxl")
library("readxl")
library("dplyr")
library(frequency)
library(rela)
library(psych)
library(FactoMineR)
library(corrplot)
library(NbClust)
library(fpc)
library(cluster)
library(fpc)
library(factoextra)
el_salvador <- read_excel("el_salvador.xlsx", range = "A2:AE6370")
nicaragua <- read_excel("nicaragua.xlsx", range = "A2:AE6374")
honduras <- read_excel("honduras.xlsx", range = "A2:AE6685")
guatemala <- read_excel("guatemala.xlsx",range = "A2:AE7719")
#en el salvador el nombre de la categoria conca se encuentra en minusculas, se transforma a mayúsculas
#para poder llevar a cabo sin problemas la función rbind
names(el_salvador)[names(el_salvador) == "conca"] <- "CONCA"
#Union de todas las tablas para crear un conjunto que represente a centroamérica
ventas.centroamerica<-rbind(guatemala,honduras,nicaragua,el_salvador)
# ------------------------ Proceso de limpieza de los datos ---------------------------
#Cambio de nombres a columnas
names(ventas.centroamerica)[names(ventas.centroamerica) == "Pagina..7"] <- "Pagina_cat"
names(ventas.centroamerica)[names(ventas.centroamerica) == "Pagina..22"] <- "Pagina"
names(ventas.centroamerica)[names(ventas.centroamerica) == "%..24"] <- "Porcentaje"
names(ventas.centroamerica)[names(ventas.centroamerica) == "%..26"] <- "Porcentaje"
#Arreglo nivel 210811 en categoría Año mes
ventas.centroamerica$`Año Mes` <- gsub("210811","201811",ventas.centroamerica$`Año Mes`)
#Quitar caracteres \r|\n de  columna descripcion
ventas.centroamerica$Descripcion <- gsub("\r|\n","",ventas.centroamerica$Descripcion)
#transformación en columna contingencia de Farma -> farma
ventas.centroamerica$Contingencia <- gsub("farma","Farma",ventas.centroamerica$Contingencia)
#Pagina | pagina derecha Pagina derecha, Pagina izquierda pagina izquierda
ventas.centroamerica$Pagina <- gsub("Pagina derecha","pagina derecha", ventas.centroamerica$Pagina)
ventas.centroamerica$Pagina <- gsub("Pagina izquierda","pagina izquierda", ventas.centroamerica$Pagina)
#Tipo Precio | intruduccion Introduccion, precio normal Precio Normal
ventas.centroamerica$`Tipo Precio` <- gsub("Introduccion","introduccion",ventas.centroamerica$`Tipo Precio`)
ventas.centroamerica$`Tipo Precio` <- gsub("Precio Normal","precio normal",ventas.centroamerica$`Tipo Precio`)
#Atributo Neto | No aplica No Aplica
ventas.centroamerica$`Atributo Neto`<- gsub("No Aplica", "No aplica", ventas.centroamerica$`Atributo Neto`)
#Energy Chart | cierre Cierre, oferta esencial Oferta esencial
ventas.centroamerica$`Energy Chart` <- gsub("Cierre","cierre", ventas.centroamerica$`Energy Chart`)
ventas.centroamerica$`Energy Chart` <- gsub("Oferta esencial","oferta esencial", ventas.centroamerica$`Energy Chart`)
#Promociones | 1 x 2 x 1 X 2 X , 2 x 2 x 2x 2x, contingencia Contingencia, Producto gratis producto gratis Producto Gratis,
#promocion precio Promocion precio Promocion Precio
ventas.centroamerica$Promociones <- gsub("1 X 2 X","1 x 2 x",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("2x 2x","2 x 2 x",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("Contingencia","contingencia",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("Producto gratis|Producto Gratis","producto gratis",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("Promocion Precio|Promocion precio","promocion precio",ventas.centroamerica$Promociones)
#Treboles extra | si SI
ventas.centroamerica$`Treboles extra` <- gsub("SI","si",ventas.centroamerica$`Treboles extra`)
#Cambio de columnas de tipo char a factor
col_names <- c("Año Mes","Producto","Codigo Catalogo","CONCA","Tipo Comision","Pagina_cat","Descripcion","Categoria","Linea","Observaciones","Canal de Venta","Contingencia","Pagina","Tipo Precio","Atributo Neto","Energy Chart","Promociones","Recursos Especiales","Treboles extra")
ventas.centroamerica$Costo <- as.numeric(ventas.centroamerica$Costo)
ventas.centroamerica[col_names] <- lapply(ventas.centroamerica[col_names] , factor)
num <- unlist(lapply(ventas.centroamerica, is.numeric))
cat <- unlist(lapply(ventas.centroamerica, is.factor))
# variables numéricas de ventas.centroamerica
vcnum <- ventas.centroamerica[,num]
# variables categóricas de ventas.centroamericas
vccat <- ventas.centroamerica[,cat]
# Método de ward para determinar número adecuado de clusters con K-means
wss <- (nrow(vcnum)-1)*sum(apply(vcnum,2,var))
for (i in 2:10)
wss[i] <- sum(kmeans(vcnum, centers=i)$withinss)
for (i in 2:10)
wss[i] <- sum(kmeans(vcnum, centers=i)$withinss)
plot(1:10, wss, type="b", xlab="Number of Clusters",  ylab="Within groups sum of squares")
#Paquete para saber el mejor n?mero de clusters
nb <- NbClust(vcnum, distance = "euclidean", min.nc = 2,max.nc = 10, method = "complete", index ="all")
for (i in 2:10)
wss[i] <- sum(kmeans(vcnum, centers=i)$withinss)
vcnum
na.omit(vcnum)
# Método de ward para determinar número adecuado de clusters con K-means
wss <- (nrow(na.omit(vcnum))-1)*sum(apply(na.omit(vcnum),2,var))
for (i in 2:10)
wss[i] <- sum(kmeans(na.omit(vcnum), centers=i)$withinss)
plot(1:10, wss, type="b", xlab="Number of Clusters",  ylab="Within groups sum of squares")
View(vcnum)
# Método de ward para determinar número adecuado de clusters con K-means
vcnum <- vcnum[complete.cases(vcnum),]
wss <- (nrow(vcnum)-1)*sum(apply(vcnum,2,var))
for (i in 2:10)
wss[i] <- sum(kmeans(vcnum, centers=i)$withinss)
plot(1:10, wss, type="b", xlab="Number of Clusters",  ylab="Within groups sum of squares")
vcnum
# Método de ward para determinar número adecuado de clusters con K-means
vcnum <- vcnum[complete.cases(vcnum),]
vcnum
View(vcnum)
# separación de variables numéricas de las categóricas
num <- unlist(lapply(ventas.centroamerica, is.numeric))
# variables numéricas de ventas.centroamerica
vcnum <- ventas.centroamerica[,num]
View(vcnum)
# Método de ward para determinar número adecuado de clusters con K-means
vcnum <- vcnum[complete.cases(vcnum),]
wss <- (nrow(vcnum)-1)*sum(apply(vcnum,2,var))
for (i in 2:10)
wss[i] <- sum(kmeans(vcnum, centers=i)$withinss)
plot(1:10, wss, type="b", xlab="Number of Clusters",  ylab="Within groups sum of squares")
#Paquete para saber el mejor n?mero de clusters
nb <- NbClust(vcnum, distance = "euclidean", min.nc = 2,max.nc = 10, method = "complete", index ="all")
#Paquete para saber el mejor n?mero de clusters
nb <- NbClust(vcnum, distance = "euclidean", min.nc = 2,max.nc = 4, method = "complete", index ="all")
#Paquete para saber el mejor n?mero de clusters
nb <- NbClust(ventas.centroamerica, distance = "euclidean", min.nc = 2,max.nc = 4, method = "centroid")
#Paquete para saber el mejor n?mero de clusters
nb <- NbClust(vcnum, distance = "euclidean", min.nc = 2,max.nc = 4, method = "centroid")
wss
sum(apply(vcnum,2,var))
wss <- (nrow(vcnum)-1)*sum(apply(vcnum,5,var))
wss <- (nrow(vcnum)-1)*sum(apply(vcnum,1,var))
sum(apply(vcnum,1,var))
wss <- (nrow(vcnum)-1)*sum(apply(vcnum,2,var))
?apply
wss <- (nrow(vcnum)-1)*sum(apply(vcnum,1,var))
for (i in 2:10)
wss[i] <- sum(kmeans(vcnum, centers=i)$withinss)
plot(1:10, wss, type="b", xlab="Number of Clusters",  ylab="Within groups sum of squares")
wss <- (nrow(vcnum)-1)*sum(apply(vcnum,c(1,2),var))
for (i in 2:10)
wss[i] <- sum(kmeans(vcnum, centers=i)$withinss)
plot(1:10, wss, type="b", xlab="Number of Clusters",  ylab="Within groups sum of squares")
wss <- (nrow(vcnum)-1)*sum(apply(vcnum,2,var))
for (i in 2:10)
wss[i] <- sum(kmeans(vcnum, centers=i)$withinss)
plot(1:10, wss, type="b", xlab="Number of Clusters",  ylab="Within groups sum of squares")
km<-kmeans(vcnum,3)
vcnum$grupo<-km$cluster
plotcluster(vcnum,km$cluster)
# gráficos que muestran la ubicación de cada cluster
plotcluster(vcnum,km$cluster)

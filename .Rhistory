<<<<<<< Updated upstream
fitPagina <- rpart(Pagina~ `Tipo Precio` , method = "class", data = ventas.centroamerica)
rpart.plot(fitPagina)
fitPagina <- rpart(Pagina~ `Tipo Precio` + Categoria + Promociones, method = "class", data = ventas.centroamerica)
rpart.plot(fitPagina)
fitPromociones <- rpart(`Canal de Venta`~ Categoria + Promociones , data = ventas.centroamerica)
rpart.plot(fitPromociones)
fitPromociones <- rpart(`Canal de Venta`~ Promociones , data = ventas.centroamerica)
rpart.plot(fitPromociones)
fitPromociones <- rpart(`Canal de Venta`~ Categoria + Promociones , data = ventas.centroamerica)
rpart.plot(fitPromociones)
View(table(ventas.centroamerica$Categoria))
table(ventas.centroamerica$Producto)
sort(table(ventas.centroamerica$Producto))
View(sort(table(ventas.centroamerica$Producto)))
View(ventas.centroamerica[ventas.centroamerica$Producto == '4323811192',])
View(ventas.centroamerica[ventas.centroamerica$Producto == '4323811192'])
View(subset(ventas.centroamerica, Producto = 4323811192))
View(subset(ventas.centroamerica, Producto = '4323811192'))
View(subset(ventas.centroamerica, Producto == '4323811192'))
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
View(head(PagGuate))
PagHon <- read.xlsx("PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
View(head(PagHon))
PagEL <- read.xlsx("PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
View(head(PagEL))
PagNi <- read.xlsx("PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
View(head(PagNi))
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
View(PagCentroamerica)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
library(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library("openxlsx")
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
setwd("~/Universidad/UVG_2019/Ciclo 2/Data Science/Proyecto2/Proyecto2_Datascience/PAGS")
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
View(head(PagGuate))
PagHon <- read.xlsx("PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
View(head(PagHon))
PagEL <- read.xlsx("PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
View(head(PagEL))
PagNi <- read.xlsx("PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
View(head(PagNi))
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
View(PagCentroamerica)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
v201501<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201501"),11])
v201502<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201502"),11])
v201503<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201503"),11])
v201504<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201504"),11])
v201505<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201505"),11])
v201506<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201506"),11])
v201507<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201507"),11])
v201508<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201508"),11])
v201509<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201509"),11])
v201510<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201510"),11])
v201511<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201511"),11])
v201512<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201512"),11])
v2015<-rbind(v201501, v201502, v201503, v201504,v201505, v201506, v201507, v201508, v201509, v201510, v201511, v201512)
v2015<-as.data.frame(v2015)
v2015$Anio <- 2015
View(v2015)
View(PagCentroamerica)
View(PagCentroamerica)
v201501<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201601"),11])
v201502<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201602"),11])
v201503<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201603"),11])
v201504<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201604"),11])
v201505<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201605"),11])
v201506<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201606"),11])
v201507<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201607"),11])
v201508<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201608"),11])
v201509<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201609"),11])
v201510<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201610"),11])
v201511<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201611"),11])
v201512<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201612"),11])
v2016<-rbind(v201501, v201502, v201503, v201504,v201505, v201506, v201507, v201508, v201509, v201510, v201511, v201512)
v2016<-as.data.frame(v2016)
v2016$Anio <- 2016
View(v2016
v201501<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201701"),11])
v201502<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201702"),11])
v201503<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201703"),11])
v201504<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201704"),11])
v201505<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201705"),11])
v201506<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201706"),11])
v201507<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201707"),11])
v201508<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201708"),11])
v201509<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201709"),11])
v201510<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201710"),11])
v201511<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201711"),11])
v201512<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201712"),11])
v2017<-rbind(v201501, v201502, v201503, v201504,v201505, v201506, v201507, v201508, v201509, v201510, v201511, v201512)
v2017<-as.data.frame(v2017)
v2017$Anio <- 2017
View(v2017)
v201501<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201801"),11])
v201502<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201802"),11])
v201503<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201803"),11])
v201504<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201804"),11])
v201505<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201805"),11])
v201506<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201806"),11])
v201507<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201807"),11])
v201508<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201808"),11])
v201509<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201809"),11])
v201510<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201810"),11])
v201511<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201811"),11])
v201512<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201812"),11])
v2018<-rbind(v201501, v201502, v201503, v201504,v201505, v201506, v201507, v201508, v201509, v201510, v201511, v201512)
v2018<-as.data.frame(v2018)
v2018$Anio <- 2018
View(v2018)
vector<-rbind(v2015, v2016, v2017, v2018)
View(vector)
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
View(PagCentroamerica)
library(class)
library(caret)
install.packages("caret")
library(caret)
datos<-mtcars
set.seed(123)
porciento <- 70/100 #Porciento en el que se partirán los datos
muestra<-sample(1:nrow(datos),porciento*nrow(datos))#Muestra aleatoria de numeros de un vector
trainSet<-datos[muestra,] #Obtengo las filas de los elementos que estan en el sector de muestra
testSet<-datos[-muestra,] #Obtengo las filas de los elementos que no están en el vector de muestra
modeloLinealSimple<-lm(mpg~wt, data = trainSet)
summary(modeloLinealSimple)
prediccion<-predict(modeloLinealSimple,newdata = testSet[,2:ncol(testSet)])
testSet$mpgPred<-prediccion
dif<-abs(testSet$mpgPred-testSet$mpg)
View(testSet)
library(class)
predKnn<-knn(trainSet[,c(1:8,10:11)],testSet[,c(1:8,10:11)],as.factor(trainSet$am),k=3)
cfm<-confusionMatrix(as.factor(testSet$am),predKnn)
cfm
View(cfm)
View(PagCentroamerica)
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
=======
ventas.centroamerica$Pagina <- gsub("Pagina izquierda","pagina izquierda", ventas.centroamerica$Pagina)
#Tipo Precio | intruduccion Introduccion, precio normal Precio Normal
ventas.centroamerica$`Tipo Precio` <- gsub("Introduccion","introduccion",ventas.centroamerica$`Tipo Precio`)
ventas.centroamerica$`Tipo Precio` <- gsub("Precio Normal","precio normal",ventas.centroamerica$`Tipo Precio`)
#Atributo Neto | No aplica No Aplica
ventas.centroamerica$`Atributo Neto`<- gsub("No Aplica", "No aplica", ventas.centroamerica$`Atributo Neto`)
#Energy Chart | cierre Cierre, oferta esencial Oferta esencial
ventas.centroamerica$`Energy Chart` <- gsub("Cierre","cierre", ventas.centroamerica$`Energy Chart`)
ventas.centroamerica$`Energy Chart` <- gsub("Oferta esencial","oferta esencial", ventas.centroamerica$`Energy Chart`)
#Promociones | 1 x 2 x 1 X 2 X , 2 x 2 x 2x 2x, contingencia Contingencia, Producto gratis producto gratis Producto Gratis,
#promocion precio Promocion precio Promocion Precio
ventas.centroamerica$Promociones <- gsub("1 X 2 X","1 x 2 x",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("2x 2x","2 x 2 x",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("Contingencia","contingencia",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("Producto gratis|Producto Gratis","producto gratis",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("Promocion Precio|Promocion precio","promocion precio",ventas.centroamerica$Promociones)
#Treboles extra | si SI
ventas.centroamerica$`Treboles extra` <- gsub("SI","si",ventas.centroamerica$`Treboles extra`)
#Cambio de columnas de tipo char a factor
col_names <- c("Año Mes","Producto","Codigo Catalogo","CONCA","Tipo Comision","Pagina_cat","Descripcion","Categoria","Linea","Observaciones","Canal de Venta","Contingencia","Pagina","Tipo Precio","Atributo Neto","Energy Chart","Promociones","Recursos Especiales","Treboles extra")
ventas.centroamerica$Costo <- as.numeric(ventas.centroamerica$Costo)
ventas.centroamerica[col_names] <- lapply(ventas.centroamerica[col_names] , factor)
ventas.centroamerica <- subset(ventas.centroamerica, is.na(Producto))
View(ventas.centroamerica)
ventas.centroamerica<-rbind(guatemala,honduras,nicaragua,el_salvador)
#Cambio de nombres a columnas
names(ventas.centroamerica)[names(ventas.centroamerica) == "Pagina...7"] <- "Pagina_cat"
names(ventas.centroamerica)[names(ventas.centroamerica) == "Pagina...22"] <- "Pagina"
names(ventas.centroamerica)[names(ventas.centroamerica) == "%...24"] <- "Porcentaje"
names(ventas.centroamerica)[names(ventas.centroamerica) == "%...26"] <- "Porcentaje2"
#Arreglo nivel 210811 en categoria A?o mes
ventas.centroamerica$`Año Mes` <- gsub("210811","201811",ventas.centroamerica$`Año Mes`)
#Quitar caracteres \r|\n de  columna descripcion
ventas.centroamerica$Descripcion <- gsub("\r|\n","",ventas.centroamerica$Descripcion)
#transformación en columna contingencia de Farma -> farma
ventas.centroamerica$Contingencia <- gsub("farma","Farma",ventas.centroamerica$Contingencia)
#Pagina | pagina derecha Pagina derecha, Pagina izquierda pagina izquierda
ventas.centroamerica$Pagina <- gsub("Pagina derecha","pagina derecha", ventas.centroamerica$Pagina)
ventas.centroamerica$Pagina <- gsub("Pagina izquierda","pagina izquierda", ventas.centroamerica$Pagina)
#Tipo Precio | intruduccion Introduccion, precio normal Precio Normal
ventas.centroamerica$`Tipo Precio` <- gsub("Introduccion","introduccion",ventas.centroamerica$`Tipo Precio`)
ventas.centroamerica$`Tipo Precio` <- gsub("Precio Normal","precio normal",ventas.centroamerica$`Tipo Precio`)
#Atributo Neto | No aplica No Aplica
ventas.centroamerica$`Atributo Neto`<- gsub("No Aplica", "No aplica", ventas.centroamerica$`Atributo Neto`)
#Energy Chart | cierre Cierre, oferta esencial Oferta esencial
ventas.centroamerica$`Energy Chart` <- gsub("Cierre","cierre", ventas.centroamerica$`Energy Chart`)
ventas.centroamerica$`Energy Chart` <- gsub("Oferta esencial","oferta esencial", ventas.centroamerica$`Energy Chart`)
#Promociones | 1 x 2 x 1 X 2 X , 2 x 2 x 2x 2x, contingencia Contingencia, Producto gratis producto gratis Producto Gratis,
#promocion precio Promocion precio Promocion Precio
ventas.centroamerica$Promociones <- gsub("1 X 2 X","1 x 2 x",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("2x 2x","2 x 2 x",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("Contingencia","contingencia",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("Producto gratis|Producto Gratis","producto gratis",ventas.centroamerica$Promociones)
ventas.centroamerica$Promociones <- gsub("Promocion Precio|Promocion precio","promocion precio",ventas.centroamerica$Promociones)
#Treboles extra | si SI
ventas.centroamerica$`Treboles extra` <- gsub("SI","si",ventas.centroamerica$`Treboles extra`)
#Cambio de columnas de tipo char a factor
col_names <- c("Año Mes","Producto","Codigo Catalogo","CONCA","Tipo Comision","Pagina_cat","Descripcion","Categoria","Linea","Observaciones","Canal de Venta","Contingencia","Pagina","Tipo Precio","Atributo Neto","Energy Chart","Promociones","Recursos Especiales","Treboles extra")
ventas.centroamerica$Costo <- as.numeric(ventas.centroamerica$Costo)
ventas.centroamerica[col_names] <- lapply(ventas.centroamerica[col_names] , factor)
ventas.centroamerica <- subset(ventas.centroamerica, !is.na(Producto))
View(ventas.centroamerica)
apply(is.na(ventas.centroamerica$Costo,1,ventas.centroamerica$Costo = 0))
source('C:/Users/anali/Desktop/Pablito/octavo_semestre/Data science/Proyecto2_Datascience/testDeImportacion.R', encoding = 'UTF-8')
view(ventas.centroamerica)
View(ventas.centroamerica)
num <- unlist(lapply(ventas.centroamerica, is.numeric))
cat <- unlist(lapply(ventas.centroamerica, is.factor))
vcnum <- ventas.centroamerica[,num]
View(vcnum)
p_uv_pro <- ventas.centroamerica[,c(2,11,12)]
>>>>>>> Stashed changes
View(p_uv_pro)
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$`Unidades.Vendidas`),by=list(Producto=p_uv_pro$Producto), FUN=sum)
p_uv_pro$diferencia <- p_uv_pro$V1 - p_uv_pro$V2
View(p_uv_pro)
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
View(p_uv_pro)
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$`Unidades.Vendidas`),by=list(Producto=p_uv_pro$Producto), FUN=sum)
p_uv_pro$diferencia <- p_uv_pro$V1 - p_uv_pro$V2
View(p_uv_pro)
#Paquetes a utilizar
install.packages("openxlsx")
install.packages("forecast")
install.packages("fUnitRoots")
library(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library(dplyr)
library("openxlsx")
install.packages("forecast")
install.packages("forecast")
install.packages("fUnitRoots")
install.packages("ggfortify")
install.packages("xts")
ibrary(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library(dplyr)
library("openxlsx")
library(forecast)
# -> Cargamos los datos de cada país individual, los juntamos para formar centroamérica
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
View(p_uv_pro_asc)
View(p_uv_pro_desc)
# -> Cargamos los datos de cada país individual, los juntamos para formar centroamérica
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
View(p_uv_pro_desc)
p_4123310125 <- PagCentroamerica[PagCentroamerica$Producto == 4123310125,]
View(p_4123310125)
p_4123310125 <- PagCentroamerica[PagCentroamerica$Producto == "4123310125",]
View(p_4123310125)
p_4123310125 <- PagCentroamerica[PagCentroamerica$Producto = "4123310125",]
p_4123310125 <- PagCentroamerica[PagCentroamerica$Producto == "4123310125",]
View(PagCentroamerica)
p_4123310125 <- PagCentroamerica[PagCentroamerica$Producto == "4123310125",]
a <- PagCentroamerica[PagCentroamerica$Producto == "4123310125",]
View(a)
a <- subset(PagCentroamerica, Producto == "4123310125")
View(a)
a <- subset(PagCentroamerica, Producto == 4123310125)
View(a)
a <- subset(PagCentroamerica, subset =  Producto == "4123310125")
View(a)
a <- subset(PagCentroamerica, subset =  Producto %in% c("4123310125"))
View(a)
a <- subset(PagCentroamerica, Producto %in% c("4123310125"))
View(a)
a <- subset(PagCentroamerica, Producto == "4123310125")
View(a)
View(PagCentroamerica)
a <- subset(PagCentroamerica, Producto == "4117080193")
a <- PagCentroamerica[PagCentroamerica$Producto == "4117080193",]
View(PagEL)
a <- PagCentroamerica[PagCentroamerica$Producto == "4117080192",]
View(a)
a <- subset(PagCentroamerica)
a <- subset(PagCentroamerica, Producto != "4123310125")
a <- subset(PagCentroamerica, Producto == "4123310125")
a <- subset(PagCentroamerica, `Producto ` == "4123310125")
a <- subset(PagCentroamerica, `Producto` == "4123310125")
colnames(PagCentroamerica)
a <- subset(PagCentroamerica, `Producto` == "4123310125")
a <- subset(PagCentroamerica, Producto == "4123310125")
a <- subset(PagCentroamerica, anomes == "201501")
names(PagCentroamerica)[2] = "producto"
a <- subset(PagCentroamerica, producto == "4123310125")
View(PagCentroamerica)
PagCentroamerica$producto <- as.factor(PagCentroamerica$producto)
a <- subset(PagCentroamerica, producto == "4123310125")
View(p_uv_pro_asc)
a <- subset(PagCentroamerica, producto == "4123310128")
a <- subset(PagCentroamerica, producto == 4123310128)
a <- subset(PagCentroamerica, producto == "4123310128")
a <- PagCentroamerica[PagCentroamerica$producto == "4123310128",]
a <- PagCentroamerica[PagCentroamerica$producto == "4123310128"]
a <- PagCentroamerica[PagCentroamerica$producto == "4123310128",]
a <- PagCentroamerica[PagCentroamerica$producto == 4123310128,]
setwd("~/Universidad/UVG_2019/Ciclo 2/Data Science/Proyecto2/Proyecto2_Datascience/PAGS")
# -> Cargamos los datos de cada país individual, los juntamos para formar centroamérica
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
setwd("~/Universidad/UVG_2019/Ciclo 2/Data Science/Proyecto2/Proyecto2_Datascience")
# -> Cargamos los datos de cada país individual, los juntamos para formar centroamérica
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
a <- subset(PagCentroamerica, producto == "4123310128")
a <- subset(PagCentroamerica, Producto == "4123310128")
a <- subset(PagCentroamerica, Producto == "4117080193")
a <- subset(PagCentroamerica, Producto != "4117080193")
View(a)
a <- subset(PagCentroamerica, Producto != 4117080193)
a <- subset(PagCentroamerica, Producto = "4117080193")
a <- subset(PagCentroamerica, Producto = "4117080193")
a <- subset(PagCentroamerica, Producto == "4117080193")
a <- subset(PagCentroamerica, Producto == "4117080193 ")
a <- subset(PagCentroamerica, Producto == "4123310125 ")
rm(a)
p_4123310125 <- subset(PagCentroamerica, Producto == "4123310125 ")
View(p_4123310125)
set.seed(123)
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
train_ind_4123310125 <- sample(seq_len(nrow(p_4123310125)), size = smp_size_4123310125)
train_4123310125 <- p_4123310125[train_ind, ]
train_4123310125 <- p_4123310125[train_ind_4123310125, ]
test_4123310125 <- p_4123310125[-train_ind_4123310125, ]
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
library(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library(dplyr)
library("openxlsx")
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
set.seed(123)
p_4123310125 <- subset(PagCentroamerica, Producto == "4123310125 ")
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
train_ind_4123310125 <- sample(seq_len(nrow(p_4123310125)), size = smp_size_4123310125)
train_4123310125 <- p_4123310125[train_ind_4123310125, ]
test_4123310125 <- p_4123310125[-train_ind_4123310125, ]
View(train_nn)
View(train_nn)
library(neuralnet)
install.packages("neuralnet")
library(neuralnet)
library(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library(dplyr)
library("openxlsx")
library(neuralnet)
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
set.seed(123)
# PRODUCTO 4123310125
p_4123310125 <- subset(PagCentroamerica, Producto == "4123310125 ")
## TRAIN Y TEST 4123310125
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
train_ind_4123310125 <- sample(seq_len(nrow(p_4123310125)), size = smp_size_4123310125)
train_4123310125 <- p_4123310125[train_ind_4123310125, ]
test_4123310125 <- p_4123310125[-train_ind_4123310125, ]
View(p_4123310125)
nn_model <- neuralnet(pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(Pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(pronostico ~., data = train_nn, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(Pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
p_4123310125 <- subset(PagCentroamerica, Producto == "4123310125 ")
p_4123310125 <- p_4123310125[,num <- unlist(lapply(PagCentroamerica, is.numeric))]
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
train_ind_4123310125 <- sample(seq_len(nrow(p_4123310125)), size = smp_size_4123310125)
train_4123310125 <- p_4123310125[train_ind_4123310125, ]
test_4123310125 <- p_4123310125[-train_ind_4123310125, ]
nn_model <- neuralnet(Pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
View(test)
View(test_4123310125)
View(p_4123310125)
p_4123310125 <- subset(PagCentroamerica, Producto == "4123310125 ")
p_4123310125 <- p_4123310125[,num <- unlist(lapply(PagCentroamerica, is.numeric))]
colnames(p_4123310125) <- c("pronostico", "unidades_vendidas", "venta_neta_sin_iva", "utilidad", "margen", "pedido_real", "ratio")
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
train_ind_4123310125 <- sample(seq_len(nrow(p_4123310125)), size = smp_size_4123310125)
train_4123310125 <- p_4123310125[train_ind_4123310125, ]
test_4123310125 <- p_4123310125[-train_ind_4123310125, ]
nn_model <- neuralnet(Pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
View(train_nn)
temp_test <- subset(test_4123310125, select = c("unidades_vendidas", "venta_neta_sin_iva", "utilidad", "margen", "pedido_real", "ratio"))
nn.results <- compute(nn_model, temp_test)
nn_model <- neuralnet(pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
temp_test <- subset(test_4123310125, select = c("unidades_vendidas", "venta_neta_sin_iva", "utilidad", "margen", "pedido_real", "ratio"))
nn.results <- compute(nn_model, temp_test)
temp_test <- subset(test_nn, select = c("precio_catalogo","precio_sin_iva","uni_vendidas","venta_neta","costo","utilidad","margen","pedido_real","ratio","porcentaje","porcentaje_2","pais_numero","categoria_numero","canalventa_numero","paginacion_numero"))
nn.results <- compute(nn_model, temp_test)
nn_model <- neuralnet(pronostico ~., data = train_nn, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
temp_test <- subset(test_nn, select = c("precio_catalogo","precio_sin_iva","uni_vendidas","venta_neta","costo","utilidad","margen","pedido_real","ratio","porcentaje","porcentaje_2","pais_numero","categoria_numero","canalventa_numero","paginacion_numero"))
nn.results <- compute(nn_model, temp_test)
<<<<<<< Updated upstream
=======
results <- data.frame(actual = test_nn$Pronostico, prediction = nn.results$net.result)
roundedresults<-sapply(results,round,digits=0)
roundedresultsdf=data.frame(roundedresults)
attach(roundedresultsdf)
table(actual,prediction)
source('C:/Users/anali/Desktop/Pablito/octavo_semestre/Data science/Proyecto2_Datascience/testDeImportacion.R', encoding = 'UTF-8')
?source
install.packages("openxlsx")
install.packages("forecast")
install.packages("fUnitRoots")
install.packages("ggfortify")
install.packages("xts")
library(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library("openxlsx")
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
View(head(PagGuate))
PagHon <- read.xlsx("PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
View(head(PagHon))
PagEL <- read.xlsx("PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
View(head(PagEL))
PagNi <- read.xlsx("PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
View(head(PagNi))
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
View(PagCentroamerica)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
View(head(PagGuate))
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
View(head(PagHon))
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
View(head(PagEL))
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
View(head(PagNi))
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
View(PagCentroamerica)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
View(head(PagGuate))
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
View(head(PagHon))
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
View(head(PagEL))
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
View(head(PagNi))
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
View(PagCentroamerica)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
p_uv_pro <- ventas.centroamerica[,c(2,10,11)]
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
View(p_uv_pro)
p_uv_pro <- PagCentroamerica[,c(1,2,10,11)]
View(p_uv_pro)
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
View(p_uv_pro)
p_uv_pro$diferencia <- p_uv_pro$V1 - p_uv_pro$V2
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
View(p_uv_pro_asc)
?subset
factor(PagCentroamerica$Año.Mes)
vamoaver <- subset(PagCentroamerica, Año.mes==201701)
library(dplyr)
vamoaver <- subset(PagCentroamerica, subset = Año.mes %in% 201701)
PagCentroamerica$Año.Mes <- PagCentroamerica$anomes
head(PagCentroamerica)
View(PagCentroamerica)
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
PagCentroamerica$Anomes <- PagCentroamerica$Año.Mes
View(PagCentroamerica)
PagCentroamerica$Año.Mes <- NULL
View(PagCentroamerica)
str(PagCentroamerica)
vamoaver <- subset(PagCentroamerica, Anomes == "201701")
View(vamoaver)
ahorasivamoaver <- subset(vamoaver, Producto == "4123310128")
View(ahorasivamoaver)
vamoaver <- subset(PagCentroamerica, Anomes == "201801")
ahorasivamoaver <- subset(vamoaver, Producto == "4123310128")
View(ahorasivamoaver)
View(vamoaver)
vamoaver <- subset(PagCentroamerica, Anomes == "2018")
View(vamoaver)
vamoaver <- subset(PagCentroamerica, Anomes %in% c("201801","201802","201803","201804","201805","201806","201807","201808","201809"))
View(vamoaver)
# -> Cargamos los datos de cada país individual, los juntamos para formar centroamérica
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
names(PagCentroamerica)[1] = "anomes"
View(PagCentroamerica)
View(PagCentroamerica)
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro)[2][3] = c("pronostico", "un_vendidas")
View(p_uv_pro)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
View(p_uv_pro_asc)
faltantes <- p_uv_pro[order(p_uv_pro$diferencia),]
View(Faltantes)
View(faltantes)
View(PagCentroamerica)
lady_shampoo <- subset(PagCentroamerica, Producto = 4123310128)
View(lady_shampoo)
str(PagCentroamerica)
lady_shampoo <- subset(PagCentroamerica, Producto == "4123310128")
View(lady_shampoo)
lady_shampoo <- subset(PagCentroamerica, Producto = "4123310128")
View(lady_shampoo)
lady_shampoo <- subset(PagCentroamerica, Producto == "4123310128")
lady_shampoo <- subset(PagCentroamerica, Producto %in% "4123310128")
lady_shampoo <- subset(PagCentroamerica, Producto %in% "4123310128")
lady_shampoo <- PagCentroamerica[which(PagCentroamerica$Producto=="4123310128")]
View(lady_shampoo)
lady_shampoo <- subset(PagCentroamerica, subset = Producto %in% "4123310128")
lady_shampoo <- subset(PagCentroamerica, subset = Producto %in% 4123310128)
str(PagCentroamerica)
lady_shampoo <- subset(PagCentroamerica, Producto == "4123310128 ")
View(lady_shampoo)
lady_shampoo <- subset(PagCentroamerica, Producto == "4124160061 ")
View(lady_shampoo)
lady_shampoo <- subset(PagCentroamerica, Producto == "4123310128 ")
View(lady_shampoo)
lady_shampoo[is.null(lady_shampoo)] <- 0
View(lady_shampoo)
?is.nukk
?is.null
lady_shampoo[lady_shampoo == NULL] <- 0
lady_shampoo[lady_shampoo == "NULL"] <- 0
View(lady_shampoo)
lady_shampoo_num <- lady_shampoo[,unlist(lapply(ventas.centroamerica, is.numeric))]
lady_shampoo_num <- lady_shampoo[,unlist(lapply(lady_shampoo, is.numeric))]
View(lady_shampoo_num)
str(lady_shampoo)
lady_shampoo$Pagina <- as.numeric(lady_shampoo$Pagina)
str(lady_shampoo)
# -> Cargamos los datos de cada país individual, los juntamos para formar centroamérica
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
PagCentroamerica[is.null(PagCentroamerica)] <- 0
PagCentroamerica[PagCentroamerica == "NULL"] <- 0
PagCentroamerica$Pagina <- as.numeric(PagCentroamerica$Pagina)
PagCentroamerica$Precio.Catalogo <- as.numeric(PagCentroamerica$Precio.Catalogo)
PagCentroamerica$`Precio.Vta.s/iva`<- as.numeric(PagCentroamerica$`Precio.Vta.s/iva`)
PagCentroamerica$Costo <- as.numeric(PagCentroamerica$Costo)
str(PagCentroamerica)
lady_shampoo <- subset(PagCentroamerica, Producto == "4123310128 ")
lady_shampoo_num <- lady_shampoo[,unlist(lapply(lady_shampoo, is.numeric))]
View(lady_shampoo_num)
library(neuralnet)
porcentaje <- 80
corte_nn<-sample(nrow(lady_shampoo_num),nrow(lady_shampoo_num)*porcentaje)
train_nn<-lady_shampoo_num[corte_nn,]
test_nn<-lady_shampoo_num[-corte_nn,]
porcentaje <- 0.8
corte_nn<-sample(nrow(lady_shampoo_num),nrow(lady_shampoo_num)*porcentaje)
train_nn<-lady_shampoo_num[corte_nn,]
test_nn<-lady_shampoo_num[-corte_nn,]
View(train_nn)
nn_model <- neuralnet(Unidades.Vendidas ~., data = train_nn, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(Unidades.Vendidas~., data = train_nn, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(Pronostico~., data = train_nn, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(Pronostico~Pagina, data = train_nn, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
PagCentroamerica[is.na(PagCentroamerica)] <- 0
PagCentroamerica$Pagina <- as.numeric(PagCentroamerica$Pagina)
PagCentroamerica$Precio.Catalogo <- as.numeric(PagCentroamerica$Precio.Catalogo)
PagCentroamerica$`Precio.Vta.s/iva`<- as.numeric(PagCentroamerica$`Precio.Vta.s/iva`)
PagCentroamerica$Costo <- as.numeric(PagCentroamerica$Costo)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
#Cambiar nombres
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
#Hacemos una diferencia
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
faltantes <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
#p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]3
# --> Analizamos cada uno de los primeros cinco productos
#Producto numero 1 - DUO SOFT LADY SHAMPOO + SPRAY
lady_shampoo <- subset(PagCentroamerica, Producto == "4123310128 ")
#Utilizamos unicamente las variables numericas para hacer el modelo de red neuronal
lady_shampoo_num <- lady_shampoo[,unlist(lapply(lady_shampoo, is.numeric))]
porcentaje <- 0.8
corte_nn<-sample(nrow(lady_shampoo_num),nrow(lady_shampoo_num)*porcentaje)
train_nn<-lady_shampoo_num[corte_nn,]
test_nn<-lady_shampoo_num[-corte_nn,]
nn_model <- neuralnet(Pronostico~Pagina, data = train_nn, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
View(train_nn)
colnames(train_nn) <- c("pagina","precio_cat","precio_venta_sinva","pronostico","u_vendidas","venta_neta_sin_iva","costo","utilidad","margen","pedido_real","ratio")
colnames(test_nn) <- c("pagina","precio_cat","precio_venta_sinva","pronostico","u_vendidas","venta_neta_sin_iva","costo","utilidad","margen","pedido_real","ratio")
nn_model <- neuralnet(u_vendidas~., data = train_nn, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model$result.matrix
nn_model$data
nn_model$response
plot(nn_model)
train_nn$results <- nn_model$response
View(train_nn)
nn_model$covariate
pred <- compute(nn_model, test_nn)
pred$neurons
pred$net.result
?compute
train_nn$results <- pred$net.result
>>>>>>> Stashed changes

fitPagina <- rpart(Pagina~ `Tipo Precio` , method = "class", data = ventas.centroamerica)
rpart.plot(fitPagina)
fitPagina <- rpart(Pagina~ `Tipo Precio` + Categoria + Promociones, method = "class", data = ventas.centroamerica)
rpart.plot(fitPagina)
fitPromociones <- rpart(`Canal de Venta`~ Categoria + Promociones , data = ventas.centroamerica)
rpart.plot(fitPromociones)
fitPromociones <- rpart(`Canal de Venta`~ Promociones , data = ventas.centroamerica)
rpart.plot(fitPromociones)
fitPromociones <- rpart(`Canal de Venta`~ Categoria + Promociones , data = ventas.centroamerica)
rpart.plot(fitPromociones)
View(table(ventas.centroamerica$Categoria))
table(ventas.centroamerica$Producto)
sort(table(ventas.centroamerica$Producto))
View(sort(table(ventas.centroamerica$Producto)))
View(ventas.centroamerica[ventas.centroamerica$Producto == '4323811192',])
View(ventas.centroamerica[ventas.centroamerica$Producto == '4323811192'])
View(subset(ventas.centroamerica, Producto = 4323811192))
View(subset(ventas.centroamerica, Producto = '4323811192'))
View(subset(ventas.centroamerica, Producto == '4323811192'))
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
View(head(PagGuate))
PagHon <- read.xlsx("PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
View(head(PagHon))
PagEL <- read.xlsx("PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
View(head(PagEL))
PagNi <- read.xlsx("PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
View(head(PagNi))
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
View(PagCentroamerica)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
library(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library("openxlsx")
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
setwd("~/Universidad/UVG_2019/Ciclo 2/Data Science/Proyecto2/Proyecto2_Datascience/PAGS")
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
View(head(PagGuate))
PagHon <- read.xlsx("PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
View(head(PagHon))
PagEL <- read.xlsx("PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
View(head(PagEL))
PagNi <- read.xlsx("PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
View(head(PagNi))
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
View(PagCentroamerica)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
v201501<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201501"),11])
v201502<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201502"),11])
v201503<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201503"),11])
v201504<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201504"),11])
v201505<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201505"),11])
v201506<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201506"),11])
v201507<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201507"),11])
v201508<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201508"),11])
v201509<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201509"),11])
v201510<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201510"),11])
v201511<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201511"),11])
v201512<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201512"),11])
v2015<-rbind(v201501, v201502, v201503, v201504,v201505, v201506, v201507, v201508, v201509, v201510, v201511, v201512)
v2015<-as.data.frame(v2015)
v2015$Anio <- 2015
View(v2015)
View(PagCentroamerica)
View(PagCentroamerica)
v201501<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201601"),11])
v201502<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201602"),11])
v201503<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201603"),11])
v201504<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201604"),11])
v201505<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201605"),11])
v201506<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201606"),11])
v201507<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201607"),11])
v201508<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201608"),11])
v201509<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201609"),11])
v201510<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201610"),11])
v201511<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201611"),11])
v201512<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201612"),11])
v2016<-rbind(v201501, v201502, v201503, v201504,v201505, v201506, v201507, v201508, v201509, v201510, v201511, v201512)
v2016<-as.data.frame(v2016)
v2016$Anio <- 2016
View(v2016
v201501<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201701"),11])
v201502<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201702"),11])
v201503<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201703"),11])
v201504<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201704"),11])
v201505<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201705"),11])
v201506<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201706"),11])
v201507<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201707"),11])
v201508<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201708"),11])
v201509<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201709"),11])
v201510<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201710"),11])
v201511<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201711"),11])
v201512<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201712"),11])
v2017<-rbind(v201501, v201502, v201503, v201504,v201505, v201506, v201507, v201508, v201509, v201510, v201511, v201512)
v2017<-as.data.frame(v2017)
v2017$Anio <- 2017
View(v2017)
v201501<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201801"),11])
v201502<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201802"),11])
v201503<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201803"),11])
v201504<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201804"),11])
v201505<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201805"),11])
v201506<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201806"),11])
v201507<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201807"),11])
v201508<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201808"),11])
v201509<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201809"),11])
v201510<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201810"),11])
v201511<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201811"),11])
v201512<-sum(PagCentroamerica[which(PagCentroamerica[,1] == "201812"),11])
v2018<-rbind(v201501, v201502, v201503, v201504,v201505, v201506, v201507, v201508, v201509, v201510, v201511, v201512)
v2018<-as.data.frame(v2018)
v2018$Anio <- 2018
View(v2018)
vector<-rbind(v2015, v2016, v2017, v2018)
View(vector)
PagGuate <- read.xlsx("PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
PagCentroamerica$Año.Mes<-as.factor(PagCentroamerica$Año.Mes)
View(PagCentroamerica)
library(class)
library(caret)
install.packages("caret")
library(caret)
datos<-mtcars
set.seed(123)
porciento <- 70/100 #Porciento en el que se partirán los datos
muestra<-sample(1:nrow(datos),porciento*nrow(datos))#Muestra aleatoria de numeros de un vector
trainSet<-datos[muestra,] #Obtengo las filas de los elementos que estan en el sector de muestra
testSet<-datos[-muestra,] #Obtengo las filas de los elementos que no están en el vector de muestra
modeloLinealSimple<-lm(mpg~wt, data = trainSet)
summary(modeloLinealSimple)
prediccion<-predict(modeloLinealSimple,newdata = testSet[,2:ncol(testSet)])
testSet$mpgPred<-prediccion
dif<-abs(testSet$mpgPred-testSet$mpg)
View(testSet)
library(class)
predKnn<-knn(trainSet[,c(1:8,10:11)],testSet[,c(1:8,10:11)],as.factor(trainSet$am),k=3)
cfm<-confusionMatrix(as.factor(testSet$am),predKnn)
cfm
View(cfm)
View(PagCentroamerica)
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
View(p_uv_pro)
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$`Unidades.Vendidas`),by=list(Producto=p_uv_pro$Producto), FUN=sum)
p_uv_pro$diferencia <- p_uv_pro$V1 - p_uv_pro$V2
View(p_uv_pro)
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
View(p_uv_pro)
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$`Unidades.Vendidas`),by=list(Producto=p_uv_pro$Producto), FUN=sum)
p_uv_pro$diferencia <- p_uv_pro$V1 - p_uv_pro$V2
View(p_uv_pro)
#Paquetes a utilizar
install.packages("openxlsx")
install.packages("forecast")
install.packages("fUnitRoots")
library(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library(dplyr)
library("openxlsx")
install.packages("forecast")
install.packages("forecast")
install.packages("fUnitRoots")
install.packages("ggfortify")
install.packages("xts")
ibrary(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library(dplyr)
library("openxlsx")
library(forecast)
# -> Cargamos los datos de cada país individual, los juntamos para formar centroamérica
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
View(p_uv_pro_asc)
View(p_uv_pro_desc)
# -> Cargamos los datos de cada país individual, los juntamos para formar centroamérica
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
View(p_uv_pro_desc)
p_4123310125 <- PagCentroamerica[PagCentroamerica$Producto == 4123310125,]
View(p_4123310125)
p_4123310125 <- PagCentroamerica[PagCentroamerica$Producto == "4123310125",]
View(p_4123310125)
p_4123310125 <- PagCentroamerica[PagCentroamerica$Producto = "4123310125",]
p_4123310125 <- PagCentroamerica[PagCentroamerica$Producto == "4123310125",]
View(PagCentroamerica)
p_4123310125 <- PagCentroamerica[PagCentroamerica$Producto == "4123310125",]
a <- PagCentroamerica[PagCentroamerica$Producto == "4123310125",]
View(a)
a <- subset(PagCentroamerica, Producto == "4123310125")
View(a)
a <- subset(PagCentroamerica, Producto == 4123310125)
View(a)
a <- subset(PagCentroamerica, subset =  Producto == "4123310125")
View(a)
a <- subset(PagCentroamerica, subset =  Producto %in% c("4123310125"))
View(a)
a <- subset(PagCentroamerica, Producto %in% c("4123310125"))
View(a)
a <- subset(PagCentroamerica, Producto == "4123310125")
View(a)
View(PagCentroamerica)
a <- subset(PagCentroamerica, Producto == "4117080193")
a <- PagCentroamerica[PagCentroamerica$Producto == "4117080193",]
View(PagEL)
a <- PagCentroamerica[PagCentroamerica$Producto == "4117080192",]
View(a)
a <- subset(PagCentroamerica)
a <- subset(PagCentroamerica, Producto != "4123310125")
a <- subset(PagCentroamerica, Producto == "4123310125")
a <- subset(PagCentroamerica, `Producto ` == "4123310125")
a <- subset(PagCentroamerica, `Producto` == "4123310125")
colnames(PagCentroamerica)
a <- subset(PagCentroamerica, `Producto` == "4123310125")
a <- subset(PagCentroamerica, Producto == "4123310125")
a <- subset(PagCentroamerica, anomes == "201501")
names(PagCentroamerica)[2] = "producto"
a <- subset(PagCentroamerica, producto == "4123310125")
View(PagCentroamerica)
PagCentroamerica$producto <- as.factor(PagCentroamerica$producto)
a <- subset(PagCentroamerica, producto == "4123310125")
View(p_uv_pro_asc)
a <- subset(PagCentroamerica, producto == "4123310128")
a <- subset(PagCentroamerica, producto == 4123310128)
a <- subset(PagCentroamerica, producto == "4123310128")
a <- PagCentroamerica[PagCentroamerica$producto == "4123310128",]
a <- PagCentroamerica[PagCentroamerica$producto == "4123310128"]
a <- PagCentroamerica[PagCentroamerica$producto == "4123310128",]
a <- PagCentroamerica[PagCentroamerica$producto == 4123310128,]
setwd("~/Universidad/UVG_2019/Ciclo 2/Data Science/Proyecto2/Proyecto2_Datascience/PAGS")
# -> Cargamos los datos de cada país individual, los juntamos para formar centroamérica
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
setwd("~/Universidad/UVG_2019/Ciclo 2/Data Science/Proyecto2/Proyecto2_Datascience")
# -> Cargamos los datos de cada país individual, los juntamos para formar centroamérica
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
a <- subset(PagCentroamerica, producto == "4123310128")
a <- subset(PagCentroamerica, Producto == "4123310128")
a <- subset(PagCentroamerica, Producto == "4117080193")
a <- subset(PagCentroamerica, Producto != "4117080193")
View(a)
a <- subset(PagCentroamerica, Producto != 4117080193)
a <- subset(PagCentroamerica, Producto = "4117080193")
a <- subset(PagCentroamerica, Producto = "4117080193")
a <- subset(PagCentroamerica, Producto == "4117080193")
a <- subset(PagCentroamerica, Producto == "4117080193 ")
a <- subset(PagCentroamerica, Producto == "4123310125 ")
rm(a)
p_4123310125 <- subset(PagCentroamerica, Producto == "4123310125 ")
View(p_4123310125)
set.seed(123)
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
train_ind_4123310125 <- sample(seq_len(nrow(p_4123310125)), size = smp_size_4123310125)
train_4123310125 <- p_4123310125[train_ind, ]
train_4123310125 <- p_4123310125[train_ind_4123310125, ]
test_4123310125 <- p_4123310125[-train_ind_4123310125, ]
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
library(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library(dplyr)
library("openxlsx")
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
set.seed(123)
p_4123310125 <- subset(PagCentroamerica, Producto == "4123310125 ")
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
train_ind_4123310125 <- sample(seq_len(nrow(p_4123310125)), size = smp_size_4123310125)
train_4123310125 <- p_4123310125[train_ind_4123310125, ]
test_4123310125 <- p_4123310125[-train_ind_4123310125, ]
View(train_nn)
View(train_nn)
library(neuralnet)
install.packages("neuralnet")
library(neuralnet)
library(forecast)
library(tseries)
library(fUnitRoots)
library(ggfortify)
library(xts)
library(dplyr)
library("openxlsx")
library(neuralnet)
PagGuate <- read.xlsx("PAGS/PAG-GT.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagGuate$Pais<-"Guatemala"
PagHon <- read.xlsx("PAGS/PAG-HO.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagHon$Pais<-"Honduras"
PagEL <- read.xlsx("PAGS/PAG-EL.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagEL$Pais<-"El Salvador"
PagNi <- read.xlsx("PAGS/PAG-NI.xlsx", sheet = 1, startRow = 1, colNames = TRUE)
PagNi$Pais<-"Nicaragua"
#PagCentroamerica es la unión de todos los individuales
PagCentroamerica <- rbind(PagGuate, PagHon, PagEL, PagNi)
#Renombramos la columna de Año.Mes
names(PagCentroamerica)[1] = "anomes"
#Volvemos factor el año y mes del data frame
PagCentroamerica$anomes<-as.factor(PagCentroamerica$anomes)
#Seleccionamos un dataframe solo con el producto, las unidades vendidas, y el pronostico por unidad
p_uv_pro <- PagCentroamerica[,c(2,10,11)]
#Agrupamos por producto, y sumamos sus u/v y pronosticos a traves de los años
p_uv_pro <- aggregate(cbind(p_uv_pro$Pronostico, p_uv_pro$Unidades.Vendidas),by=list(Producto=p_uv_pro$Producto), FUN=sum)
names(p_uv_pro) = c("producto","pronostico", "un_vendidas")
p_uv_pro$diferencia <- p_uv_pro$pronostico - p_uv_pro$un_vendidas
#Faltantes
p_uv_pro_asc <- p_uv_pro[order(p_uv_pro$diferencia),]
#Excedente
p_uv_pro_desc <- p_uv_pro[order(-p_uv_pro$diferencia),]
set.seed(123)
# PRODUCTO 4123310125
p_4123310125 <- subset(PagCentroamerica, Producto == "4123310125 ")
## TRAIN Y TEST 4123310125
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
train_ind_4123310125 <- sample(seq_len(nrow(p_4123310125)), size = smp_size_4123310125)
train_4123310125 <- p_4123310125[train_ind_4123310125, ]
test_4123310125 <- p_4123310125[-train_ind_4123310125, ]
View(p_4123310125)
nn_model <- neuralnet(pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(Pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(pronostico ~., data = train_nn, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(Pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
p_4123310125 <- subset(PagCentroamerica, Producto == "4123310125 ")
p_4123310125 <- p_4123310125[,num <- unlist(lapply(PagCentroamerica, is.numeric))]
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
train_ind_4123310125 <- sample(seq_len(nrow(p_4123310125)), size = smp_size_4123310125)
train_4123310125 <- p_4123310125[train_ind_4123310125, ]
test_4123310125 <- p_4123310125[-train_ind_4123310125, ]
nn_model <- neuralnet(Pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
View(test)
View(test_4123310125)
View(p_4123310125)
p_4123310125 <- subset(PagCentroamerica, Producto == "4123310125 ")
p_4123310125 <- p_4123310125[,num <- unlist(lapply(PagCentroamerica, is.numeric))]
colnames(p_4123310125) <- c("pronostico", "unidades_vendidas", "venta_neta_sin_iva", "utilidad", "margen", "pedido_real", "ratio")
smp_size_4123310125 <- floor(0.80 * nrow(p_4123310125))
train_ind_4123310125 <- sample(seq_len(nrow(p_4123310125)), size = smp_size_4123310125)
train_4123310125 <- p_4123310125[train_ind_4123310125, ]
test_4123310125 <- p_4123310125[-train_ind_4123310125, ]
nn_model <- neuralnet(Pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
nn_model <- neuralnet(pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
View(train_nn)
temp_test <- subset(test_4123310125, select = c("unidades_vendidas", "venta_neta_sin_iva", "utilidad", "margen", "pedido_real", "ratio"))
nn.results <- compute(nn_model, temp_test)
nn_model <- neuralnet(pronostico ~., data = train_4123310125, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
temp_test <- subset(test_4123310125, select = c("unidades_vendidas", "venta_neta_sin_iva", "utilidad", "margen", "pedido_real", "ratio"))
nn.results <- compute(nn_model, temp_test)
temp_test <- subset(test_nn, select = c("precio_catalogo","precio_sin_iva","uni_vendidas","venta_neta","costo","utilidad","margen","pedido_real","ratio","porcentaje","porcentaje_2","pais_numero","categoria_numero","canalventa_numero","paginacion_numero"))
nn.results <- compute(nn_model, temp_test)
nn_model <- neuralnet(pronostico ~., data = train_nn, hidden=c(4,3,2,1), linear.output=FALSE, threshold=0.01 )
temp_test <- subset(test_nn, select = c("precio_catalogo","precio_sin_iva","uni_vendidas","venta_neta","costo","utilidad","margen","pedido_real","ratio","porcentaje","porcentaje_2","pais_numero","categoria_numero","canalventa_numero","paginacion_numero"))
nn.results <- compute(nn_model, temp_test)
